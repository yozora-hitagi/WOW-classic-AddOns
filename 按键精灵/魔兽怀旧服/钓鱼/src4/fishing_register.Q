[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=9cdc1254-078a-4f86-822a-867e5180e7ae
Description=fishing_register
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]

//字符串加解密， 相同字符操作 5个， 解密会失败。 不晓得为啥



Function RegistCode()
    GetSN = Plugin.Sys.GetHDDSN()
    RegistCode = Plugin.Encrypt.Md5String(GetSN)
End Function


Function AppendToInputBox3(str)
    If Form1.InputBox3.Text = "" Then 
        Form1.InputBox3.Text = str
    Else 
        Form1.InputBox3.Text = Form1.InputBox3.Text & Chr(13) & Chr(10) & Chr(13) & Chr(10) & str
    End If
    
End Function

Event Form1.Load
    Form1.InputBox1.Text = RegistCode()
    Form1.InputBox2.Text = 35
	
    返回值 = Lib.网络.获取网络时间_增强版("www.taobao.com")
    AppendToInputBox3 (返回值)

End Event




Event Form1.Button1.Click
	
    mc = Form1.InputBox1.Text
    mc = Trim(mc)
	
	
    Timeout = Int(Form1.InputBox2.Text)
    If Timeout = "" Then 
        MessageBox "请输入正确的有效期！"
    End If
	
	
    enddate = DateAdd("d", Timeout, Date)
	
    AppendToInputBox3 ("当前日期：" & Date)
    AppendToInputBox3 ("到期日期：" & enddate)
	
	
    y = Year(enddate)
    m = Month(enddate)
    d = Day(enddate)
	
    str = mc & "|" & y & "|" & m & "|" & d
    
    AppendToInputBox3 ("License明文："&str)    
	
    iCipher  = Plugin.Encrypt.StringEncode(str, "whoisyourdaddy")
    
    AppendToInputBox3 ("License密文："&iCipher)
    
     
    iPlain = Plugin.Encrypt.StringDecode(iCipher, "whoisyourdaddy")
    
    AppendToInputBox3 ("License验证："&iPlain)

	
    IsFile = Plugin.File.IsFileExist(Form1.BrowseBox1.Path & "\fishing.lic")
    If IsFile = True Then 
        Call Plugin.File.DeleteFile(Form1.BrowseBox1.Path & "\fishing.lic")

    End If


    lic_f = Plugin.File.OpenFile(Form1.BrowseBox1.Path & "\fishing.lic")
    Call Plugin.File.WriteFile(lic_f, iCipher)
    Call Plugin.File.CloseFile(lic_f)




	
	
	
End Event


Event Form1.InputBox2.Change
	
    Timeout = Int(Form1.InputBox2.Text)
    If Timeout = "" Then 
        MessageBox "请输入数字！"
    End If
	
End Event